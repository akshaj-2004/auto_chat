# ğŸ“¦ Registration Bot with Ollama

## Overview
A FastAPI service that lets users register, retrieve, update, and delete user records via a conversational LLM interface. The LLM runs locally with **Ollama** (default model: `llama3.1`).

---

## ğŸ“‹ Prerequisites
- **Python 3.11+**
- **Ollama** installed and running (`ollama serve`)
- **PostgreSQL** (or any DB supported by SQLAlchemy) â€“ set `DATABASE_URL` in a `.env` file

---

## ğŸš€ Installation
```bash
# Clone the repo
git clone <repo-url>
cd py_dev

# Create a virtual environment
python3 -m venv .venv
source .venv/bin/activate

# Install dependencies
pip install -r requirements.txt
```

---

## ğŸ¦™ Ollama Model Setup
```bash
# Pull the recommended model (llama3.1) â€“ works best with native tool calling
ollama pull llama3.1
```
If you prefer another model that supports tool calling, replace `mistral` with the model name.

---

## âš™ï¸ Configuration
Create a `.env` file in the project root:
```dotenv
DATABASE_URL=postgresql+psycopg2://user:password@localhost/registration_db
```
Run the migrations (or let SQLAlchemy create tables on first start):
```bash
# The first request will autoâ€‘create tables, or you can use Alembic if set up.
```

---

## â–¶ï¸ Running the API
```bash
uvicorn app.main:app --reload
```
The service will be available at `http://127.0.0.1:8000`.

### Endpoints
| Method | Path | Description |
|--------|------|-------------|
| `POST /chat/{session_id}` | Conversational endpoint â€“ send a JSON `{ "message": "â€¦" }` |
| `GET /docs` | Swagger UI |
| `GET /redoc` | ReDoc UI |

Additional userâ€‘related routes are defined in `app/routes/user.py`.

---

## ğŸ§ª Testing
### Automated tests
Automated tests can be added as needed. Manual testing can be performed with any HTTP client (e.g., curl, Postman, or the Swagger UI).
```bash
python -m pytest test_conversational.py
```
### Manual testing with Postman
Import `postman_collection.json` (generated by the project) into Postman and execute the **Chat** request. It will hit the `/chat/{session_id}` endpoint.

### Example flow
1. **Start a session**
   ```json
   POST /chat/session1
   { "message": "Hi! I want to register a new user" }
   ```
   â†’ Bot asks for missing fields.
2. **Provide details**
   ```json
   POST /chat/session1
   { "message": "Name: Alice, email: alice@example.com, phone: 5551234567, DOB: 1990-01-01" }
   ```
   â†’ Bot creates the registration and returns a success message.

---

## ğŸ§¹ Cleanâ€‘up
```bash
# Remove the pulled model if you need space
ollama rm mistral
```

---

## ğŸ“„ License
MIT â€“ feel free to adapt and extend.
# auto_chat
